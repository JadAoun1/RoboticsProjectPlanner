{% extends 'base.html' %}

{% block title %}
    {% if form.instance.pk %}
        Edit Tool
    {% else %}
        Add Tool
    {% endif %} - {{ project.project_name }} - RoboPlanner
{% endblock %}

{% block content %}
<div class="form-container" style="max-width: 600px; margin: 0 auto">
  <!-- Breadcrumb Navigation -->
  <nav aria-label="breadcrumb" class="mb-3">
    <div class="breadcrumb text-sm text-muted">
      <a href="{% url 'projects:dashboard' %}" class="text-primary">My Projects</a>
      <span class="mx-2">â€º</span>
      <a href="{% url 'projects:detail' project.pk %}" class="text-primary">{{ project.project_name }}</a>
      <span class="mx-2">â€º</span>
      <span>{% if form.instance.pk %}Edit Tool{% else %}Add Tool{% endif %}</span>
    </div>
  </nav>

  <div class="card">
    <div class="card-header">
      <h1 class="card-title">
        <span aria-hidden="true">ðŸ”§</span>
        {% if form.instance.pk %}
        <span class="text-primary">Edit Tool</span>
        {% else %}
        <span class="text-primary">Add New Tool</span>
        {% endif %}
      </h1>
      <p class="text-muted">
        {% if form.instance.pk %}
            Update the tool details
        {% else %}
            Add a tool required for this project
        {% endif %}
      </p>
    </div>

    <div class="card-body">
      <form method="post" novalidate>
        {% csrf_token %}
        
        {% if form.non_field_errors %}
        <div class="alert alert-danger" role="alert">
          {% for error in form.non_field_errors %}
          <p>{{ error }}</p>
          {% endfor %}
        </div>
        {% endif %}

        <div class="form-group">
          <label for="{{ form.tool_name.id_for_label }}" class="form-label">
            Tool Name <span class="text-danger" aria-label="required">*</span>
          </label>
          {{ form.tool_name }}
          {% if form.tool_name.errors %}
          <div class="text-danger mt-1" role="alert">
            {% for error in form.tool_name.errors %}
            <small>{{ error }}</small>
            {% endfor %}
          </div>
          {% endif %}
          <small class="text-muted">
            Be specific (e.g., "Soldering Iron 40W", "Multimeter", "Breadboard")
          </small>
        </div>

        <div class="form-group">
          <label for="{{ form.notes.id_for_label }}" class="form-label">
            Notes & Details
          </label>
          {{ form.notes }}
          {% if form.notes.errors %}
          <div class="text-danger mt-1" role="alert">
            {% for error in form.notes.errors %}
            <small>{{ error }}</small>
            {% endfor %}
          </div>
          {% endif %}
          <small class="text-muted">
            Specifications, where to find it, or why it's needed
          </small>
        </div>

        <!-- Tool Tips -->
        <div
          class="tool-tips card"
          style="background: #f0fdf4; border-color: #bbf7d0; margin: 1.5rem 0"
        >
          <div class="card-body">
            <h3 class="text-secondary mb-2">ðŸ’¡ Tool Tips</h3>
            <ul
              class="text-sm text-muted"
              style="margin: 0; padding-left: 1.5rem"
            >
              <li>List both owned and needed tools</li>
              <li>Include power requirements or specifications</li>
              <li>Note if substitutes are acceptable</li>
            </ul>
          </div>
        </div>

        <div class="form-actions flex gap-2 mt-4">
          <button type="submit" class="btn btn-primary">
            {% if form.instance.pk %}
            <span aria-hidden="true">ðŸ’¾</span> Update Tool
            {% else %}
            <span aria-hidden="true">ðŸ”§</span> Add Tool
            {% endif %}
          </button>

          <a
            href="{% url 'projects:detail' project.pk %}"
            class="btn btn-outline"
          >
            Cancel
          </a>
        </div>
      </form>
    </div>
  </div>

  <!-- Quick Add More -->
  {% if not form.instance.pk %}
  <div class="quick-add mt-4">
    <div class="card" style="background: #fef3c7; border-color: #fed7aa">
      <div class="card-body text-center">
        <h3 class="text-secondary mb-2">Adding Multiple Tools?</h3>
        <p class="text-muted mb-3">
          After saving this tool, you can quickly add another one.
        </p>
        <div class="common-tools">
          <p class="text-sm text-muted">Common robotics tools:</p>
          <div class="tools-grid grid grid-3 mt-2" style="gap: 0.5rem">
            <span class="tool-chip">Soldering Iron</span>
            <span class="tool-chip">Multimeter</span>
            <span class="tool-chip">Wire Strippers</span>
            <span class="tool-chip">Breadboard</span>
            <span class="tool-chip">Screwdriver Set</span>
            <span class="tool-chip">Hot Glue Gun</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endif %}
</div>
{% endblock %}

{% block extra_head %}
<style>
  .breadcrumb {
    padding: 0.75rem 0;
  }

  .form-actions {
    border-top: 1px solid var(--border);
    padding-top: 1.5rem;
    margin-top: 1.5rem;
  }

  .tool-chip {
    display: inline-block;
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    color: var(--text-muted);
  }

  .tools-grid {
    text-align: left;
  }

  @media (max-width: 768px) {
    .form-actions {
      flex-direction: column;
    }

    .form-actions .btn {
      justify-content: center;
    }

    .tools-grid {
      grid-template-columns: 1fr 1fr;
    }
  }
</style>
{% endblock %}

